%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 120 910 704
%%BeginComments
%%Creator: RNAbow (DP Aalberts, WK Jannen)
%%Title: Difference RNAbow
%%Document-Fonts: Courier
%%EndComments

/m {newpath moveto} bind def
/l {lineto} bind def
/cp {closepath} bind def
/s {stroke} bind def
/sh {show} bind def
/sg {setgray} bind def 
/srgb {setrgbcolor} bind def
/slw {setlinewidth} bind def

/lseq 89 def
/heightB 430 def
/heightT 474 def
/heightBt 438 def
/heightTt 456 def
/height1 641.5 def
/height2 162.5 def
/topcolor 0 def % specify top arc color here.  Hue range [0,1]
/botcolor 0.667 def % specify bottom arc color here.  Hue range [0,1]

/xcent { i j add 10 mul 2 div } bind def
/radius { j i sub 10 mul 2 div } bind def
/top { /Xij exch def /Pij exch def /j exch def /i exch def
    topcolor Xij Xij Pij sub 1 add sethsbcolor
%    Xij Pij div 0 0 setrgbcolor
    Pij 10 mul setlinewidth
    xcent heightT radius 0 180 arc stroke } bind def
/bot { /Xij exch def /Pij exch def /j exch def /i exch def
    botcolor Xij Xij Pij sub 1 add sethsbcolor
%    0 0 Xij Pij div setrgbcolor
    Pij 10 mul setlinewidth
    xcent heightB radius 180 0 arc stroke } bind def

/s1 (GGUGGCUUCGAGUAGAAGCCUUAUGUACCGGAAGGUGCGAAUCUUCCGAAGGAUCCGAGUAGGAUCCAAAAAGAAACAACAACAACAAC) def
/s2 (GGUGGCUUCGAGUAGAAGCCUUAUGUACCGGAAGGUGCGAAUCUUCCGAAGGAUCCGAGUAGGAUCCAAAAAGAAACAACAACAACAAC) def

%check for base substitutions.  if found, push the location of the substitution into ca
/idx 0 def
/ca [lseq { s1 idx get s2 idx get ne { idx  } if /idx idx 1 add def } repeat] def

10 0 translate
gsave
/Courier findfont 15 scalefont setfont
5 heightTt moveto
/idx 0 def
/idx2 0 def
/gswitch 0 def
lseq {idx 10 mod 0 eq gswitch 0 eq xor {.35 setgray /gswitch 0 def} {0 setgray /gswitch 1 def} ifelse ca length idx2 gt { ca idx2 get idx eq { topcolor 1 1 sethsbcolor /idx2 idx2 1 add def } if } if  s1 idx 1 getinterval [10] xshow /idx idx 1 add def} repeat

5 heightBt moveto
/idx 0 def
/idx2 0 def
/gswitch 0 def
lseq {idx 10 mod 0 eq gswitch 0 eq xor {.35 setgray /gswitch 0 def} {0 setgray /gswitch 1 def} ifelse ca length idx2 gt { ca idx2 get idx eq { botcolor 1 1 sethsbcolor /idx2 idx2 1 add def } if } if  s2 idx 1 getinterval [10] xshow /idx idx 1 add def} repeat

0.0 sg 1 slw  105 448 m 105 456 l s 
0.0 sg 1 slw  205 448 m 205 456 l s 
0.0 sg 1 slw  305 448 m 305 456 l s 
0.0 sg 1 slw  405 448 m 405 456 l s 
0.0 sg 1 slw  505 448 m 505 456 l s 
0.0 sg 1 slw  605 448 m 605 456 l s 
0.0 sg 1 slw  705 448 m 705 456 l s 
0.0 sg 1 slw  805 448 m 805 456 l s 
21 41 0.012 0.012 top
3 79 0.018 0.007 top
3 82 0.018 0.006 top
3 85 0.018 0.006 top
1 22 0.023 0 top
2 21 0.027 0 top
3 76 0.027 0.017 top
2 80 0.034 0.014 top
2 83 0.034 0.012 top
2 86 0.034 0.011 top
2 77 0.042 0.023 top
22 40 0.058 0.058 top
44 75 0.068 0.068 top
45 74 0.086 0.086 top
46 73 0.087 0.087 top
1 47 0.102 0.102 top
2 46 0.102 0.102 top
42 49 0.183 0.183 top
43 48 0.189 0.189 top
45 71 0.296 0.296 top
42 74 0.321 0.321 top
44 72 0.346 0.346 top
43 73 0.351 0.351 top
24 39 0.555 0.555 top
4 20 0.991 0 top
51 67 0.997 0 top
27 36 0.998 0.998 top
29 34 0.998 0.998 top
5 19 0.999 0 top
7 17 0.999 0 top
8 16 0.999 0 top
9 15 0.999 0 top
25 38 0.999 0.999 top
26 37 0.999 0.999 top
28 35 0.999 0.999 top
52 66 0.999 0 top
53 65 0.999 0 top
54 64 0.999 0 top
55 63 0.999 0 top
56 62 0.999 0 top
6 18 1.000 0 top
3 76 0.010 0 bot
2 28 0.011 0.011 bot
3 27 0.011 0.011 bot
3 79 0.011 0 bot
3 82 0.012 0 bot
3 85 0.012 0 bot
2 77 0.019 0 bot
2 80 0.020 0 bot
2 83 0.022 0 bot
2 86 0.023 0 bot
1 22 0.031 0.008 bot
2 21 0.036 0.009 bot
24 87 0.072 0.072 bot
24 84 0.073 0.073 bot
24 81 0.074 0.074 bot
24 78 0.075 0.075 bot
26 85 0.081 0.081 bot
26 82 0.083 0.083 bot
26 79 0.084 0.084 bot
26 76 0.085 0.085 bot
25 86 0.087 0.087 bot
25 83 0.089 0.089 bot
25 80 0.090 0.090 bot
25 77 0.091 0.091 bot
29 48 0.964 0.964 bot
36 41 0.975 0.975 bot
35 42 0.988 0.988 bot
4 20 0.993 0.002 bot
33 44 0.998 0.998 bot
51 67 0.998 0.001 bot
5 19 0.999 0 bot
7 17 0.999 0 bot
8 16 0.999 0 bot
9 15 0.999 0 bot
30 47 0.999 0.999 bot
31 46 0.999 0.999 bot
32 45 0.999 0.999 bot
34 43 0.999 0.999 bot
52 66 0.999 0 bot
53 65 0.999 0 bot
54 64 0.999 0 bot
55 63 0.999 0 bot
56 62 0.999 0 bot
6 18 1.000 0 bot
0 sg /Courier findfont 33.2 scalefont setfont
10 height1 m (alpha, p=0.009) show
/height1 height1 33.2 sub def
10 height2 m (beta, p=0.991) show
/height2 height2 33.2 add def
grestore
